# 作用域

## 什么是作用域

&emsp;&emsp;基本上所有语言中都具备一个功能,可以定义一个变量并在之后对这个变量进行赋值和修改。正式这种存储和访问变量的能力给了程序高度的灵活。没有这个能力，程序虽然能执行一些简单的任务，但是没有那么的灵活，会显得有一些死板。但是将变量引入程序中同时会来带一些问题：变量存储在哪里，什么时候应用它。 怎么解决这些问题，需要引入一套合理的规则去存储变量以及在合适的时候去引用它，这一套规则就称之为作用域。

## 编译原理

&emsp;&emsp;传统的语言像 Java，C++等一些语言中程序的编译分为三步：

- 分词/词法分析（Tokenizing/Lexing）

  &emsp;&emsp;这个过程会讲字符组成的字符串分解成为对编程语言来说有意义的代码块，这些代码块称为词法单元。例如 var a = 2;这段程序通常会被分解城["var","a","=","2"]。

> 分词（tokenizing）和词法分析（Lexing）之间的区别是非常微妙、晦涩的，主要差异在于词法单元的识别是通过有状态还是无状态的方式进行的。简单来说，如果词法单元生成器在判断 a 是一个独立的词法单元还是其他词法单元的一部分时，调用的是有状态的解析规则，那么这个过程就被称为词法分析。

- 解析/语法分析（Parsing）

  &emsp;&emsp;这个过程中会讲词法单元装换成一个元素逐级嵌套所组成的代表了程序语法结构的树。这树被称为抽象语法树（Abstract Syntax Tree,AST）。

- 代码生成

  &emsp;&emsp;将 AST 转换为可执行代码的过程被称为代码生成。这个过程与语言、目标平台等息息相关。抛开具体细节，简单来说就是有某种方法可以将 var a = 2；的 AST 转化为一组机器指令，用来创建一个叫作 a 的变量（包括分配内存等），并将一个值储存在 a 中。

&emsp;&emsp;比起这些传统的编程语言，JavaScript 引擎要复杂的多，例如，会在词法分析和代码生成的时候对特定步骤来对运行性能进行优化，包括对冗余元素进行优化。

&emsp;&emsp;首先 js 是一门动态语言，JavaScript 引擎没有那么多时间来进行优化，与其他语言不同，JavaScript 编译过程不是发生在之前构建的。

&emsp;&emsp;对 JavaScript 来说大部分情况下编译是在执行前那么几微秒。在我们所要讨论的作用域背后，JavaScript 引擎用尽了各种办法（比如 JIT，可以延迟编译甚至实施重编译）来保证性能最佳。

&emsp;&emsp;简单地说，任何 JavaScript 代码片段在执行前都要进行编译（通常就在执行前）。因此，JavaScript 编译器首先会对 var a = 2；这段程序进行编译，然后做好执行它的准备，并且通常马上就会执行它。

## 作用域
